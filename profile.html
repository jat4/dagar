<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Indiagram</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Grand+Hotel&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style> 
        body { font-family: 'Inter', sans-serif; background: #fafafa; } 
        .font-insta { font-family: 'Grand Hotel', cursive; }
        .modal-animate { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut, updateProfile, updateEmail, deleteUser } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, onSnapshot, updateDoc, collection, query, where, getDocs, addDoc, serverTimestamp, deleteDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getDatabase, ref, remove, set, serverTimestamp as rtdbTimestamp, onDisconnect } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { apiKey: "AIzaSyBIWFvOKLOpOFfik5YmsERR9pVLjs7tYTc", authDomain: "make-a-site.firebaseapp.com", projectId: "make-a-site", storageBucket: "make-a-site.firebasestorage.app", messagingSenderId: "1099071295300", appId: "1:1099071295300:web:c5e997a1591b9ffee55111" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const rtdb = getDatabase(app);

        // ... [Navbar, AboutAccountModal, UserListModal, EditProfileModal, deleteUserDataFromDB remain SAME] ...
        function Navbar({ onLogout }) { const [showSettings, setShowSettings] = React.useState(false); return ( <nav className="bg-white border-b h-16 flex items-center justify-between px-4 sticky top-0 z-50"> <h1 className="font-insta text-3xl cursor-pointer bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-orange-500" onClick={()=>window.location.href='home.html'}>Indiagram</h1> <div className="flex gap-4 items-center"> <a href="home.html" className="material-icons-round text-3xl text-slate-600 hover:text-black">home</a> <a href="search.html" className="material-icons-round text-3xl text-slate-600 hover:text-black">search</a> <a href="message-list.html" className="material-icons-round text-3xl text-slate-600 hover:text-black">chat</a> <a href="notifications.html" className="material-icons-round text-3xl text-slate-600 hover:text-black">favorite_border</a> <a href="profile.html" className="material-icons-round text-3xl text-black">account_circle</a> <div className="relative"> <button onClick={()=>setShowSettings(!showSettings)}><span className="material-icons-round text-3xl text-slate-600 hover:text-black">settings</span></button> {showSettings && ( <div className="absolute right-0 top-10 bg-white border shadow-lg rounded-lg w-32 py-1 z-50"> <button onClick={onLogout} className="w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-slate-50 font-bold">Logout</button> </div> )} </div> </div> </nav> ); }
        function AboutAccountModal({ user, onClose }) { const dateJoined = user.createdAt ? new Date(user.createdAt.seconds * 1000).toLocaleDateString('en-US', { month: 'long', year: 'numeric' }) : 'September 2021'; const verifiedDate = user.verifiedAt ? new Date(user.verifiedAt.seconds * 1000).toLocaleDateString('en-US', { month: 'long', year: 'numeric' }) : 'Not Verified'; return ( <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onClick={onClose}> <div className="bg-white rounded-2xl w-full max-w-sm overflow-hidden flex flex-col modal-animate shadow-2xl" onClick={e => e.stopPropagation()}> <div className="p-3 border-b text-center font-bold text-sm relative"> About this account <button onClick={onClose} className="absolute right-3 top-3"><span className="material-icons-round text-sm">close</span></button> </div> <div className="p-6 flex flex-col items-center"> <img src={user.photoURL || "https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png"} className="w-20 h-20 rounded-full border mb-3 object-cover" /> <h2 className="font-bold text-lg flex items-center gap-1 mb-2"> {user.username} {user.isVerified && <span className="material-icons-round text-blue-500 text-lg">verified</span>} </h2> <p className="text-center text-xs text-slate-500 mb-6 leading-relaxed"> To help keep our community authentic, we're showing information about accounts on Indiagram. </p> <div className="w-full space-y-4"> <div className="flex items-center gap-4"> <span className="material-icons-round text-2xl text-slate-800">calendar_today</span> <div> <p className="text-sm font-medium text-slate-900">Date joined</p> <p className="text-xs text-slate-500">{dateJoined}</p> </div> </div> <div className="flex items-center gap-4"> <span className="material-icons-round text-2xl text-slate-800">public</span> <div> <p className="text-sm font-medium text-slate-900">Account based in</p> <p className="text-xs text-slate-500">{user.country || 'India'}</p> </div> </div> {user.usernameChangeCount > 0 && ( <div className="flex items-center gap-4 justify-between w-full"> <div className="flex items-center gap-4"> <span className="material-icons-round text-2xl text-slate-800">person_outline</span> <div> <p className="text-sm font-medium text-slate-900">Former usernames</p> </div> </div> <div className="flex items-center text-slate-500"> <span className="text-sm font-bold mr-1">{user.usernameChangeCount}</span> <span className="material-icons-round text-lg">chevron_right</span> </div> </div> )} <div className="flex items-center gap-4"> <span className="material-icons-round text-2xl text-slate-800">verified</span> <div> <p className="text-sm font-medium text-slate-900">Verified</p> <p className="text-xs text-slate-500">{user.isVerified ? verifiedDate : "Not verified"}</p> </div> </div> </div> <button onClick={onClose} className="mt-6 w-full py-2.5 rounded-lg font-bold text-sm text-slate-800 bg-slate-100 hover:bg-slate-200"> Close </button> </div> </div> </div> ); }
        function UserListModal({ title, users, onClose }) { return ( <div className="fixed inset-0 z-[70] bg-black/60 flex items-center justify-center p-4" onClick={onClose}> <div className="bg-white rounded-xl w-full max-w-sm max-h-[70vh] flex flex-col modal-animate overflow-hidden" onClick={e => e.stopPropagation()}> <div className="p-3 border-b flex justify-between items-center bg-slate-50"> <h3 className="font-bold">{title}</h3> <button onClick={onClose}><span className="material-icons-round">close</span></button> </div> <div className="overflow-y-auto p-2"> {!users || users.length === 0 ? ( <p className="text-center p-10 text-slate-500 text-sm">List is empty.</p> ) : ( users.map(u => ( <div key={u.uid} className="flex items-center gap-3 p-3 hover:bg-slate-50 rounded-lg cursor-pointer" onClick={()=>window.location.href=`profile.html?uid=${u.uid}`}> <img src={u.photoURL || "https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png"} className="w-10 h-10 rounded-full bg-slate-200 object-cover border" /> <div> <p className="font-bold text-sm flex items-center gap-1">{u.username} {u.isVerified && <span className="material-icons-round text-blue-500 text-sm">verified</span>}</p> <p className="text-xs text-slate-500">{u.name}</p> </div> </div> )) )} </div> </div> </div> ); }
        function EditProfileModal({ user, onClose }) { const [name, setName] = React.useState(user.name); const [username, setUsername] = React.useState(user.username); const [email, setEmail] = React.useState(user.email || ''); const [bio, setBio] = React.useState(user.bio || ''); const [photo, setPhoto] = React.useState(user.photoURL || ''); const [showActivity, setShowActivity] = React.useState(user.showActivityStatus !== false); const [readReceipts, setReadReceipts] = React.useState(user.readReceipts !== false); const [loading, setLoading] = React.useState(false); const fileRef = React.useRef(); const handleFile = (e) => { const file = e.target.files[0]; if (file) { const reader = new FileReader(); reader.onload = () => setPhoto(reader.result); reader.readAsDataURL(file); } }; const handleSave = async () => { setLoading(true); try { const cleanUsername = username.toLowerCase().trim(); let changeCount = user.usernameChangeCount || 0; if (cleanUsername !== user.username) { if (!/^[a-z0-9._]+$/.test(cleanUsername)) { alert("Username can only contain letters, numbers, underscores (_) and dots (.)"); setLoading(false); return; } if (cleanUsername.startsWith('.') || cleanUsername.endsWith('.')) { alert("Username cannot start or end with a dot (.)"); setLoading(false); return; } const qCheck = query(collection(db, "users"), where("username", "==", cleanUsername)); const snapCheck = await getDocs(qCheck); if (!snapCheck.empty) { alert("Username already taken! Please choose another."); setLoading(false); return; } changeCount += 1; } await updateDoc(doc(db, "users", user.uid), { name, username: cleanUsername, bio, photoURL: photo, usernameChangeCount: changeCount, showActivityStatus: showActivity, readReceipts: readReceipts, email }); if(auth.currentUser) await updateProfile(auth.currentUser, { displayName: name }); const statusRef = ref(rtdb, '/status/' + user.uid); if (showActivity) { set(statusRef, { state: 'online', last_changed: rtdbTimestamp() }); onDisconnect(statusRef).set({ state: 'offline', last_changed: rtdbTimestamp() }); } else { remove(statusRef); } alert("Saved!"); onClose(); } catch(e) { alert("Error: " + e.message); } finally { setLoading(false); } }; const handleDeleteAccount = async () => { if(!confirm("Delete account permanently?")) return; try { await deleteUserDataFromDB(user.uid); await deleteUser(auth.currentUser); window.location.href = "index.html"; } catch(e) { alert("Please relogin to delete."); } }; return ( <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[60]"> <div className="bg-white p-6 rounded-xl w-96 max-h-[90vh] overflow-y-auto modal-animate"> <h3 className="font-bold mb-4 text-xl">Edit Profile</h3> <div className="flex flex-col items-center mb-4"> <img src={photo || "https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png"} className="w-20 h-20 rounded-full object-cover border mb-2" /> <button onClick={()=>fileRef.current.click()} className="text-blue-500 font-bold text-sm">Change Photo</button> <input type="file" ref={fileRef} hidden accept="image/*" onChange={handleFile} /> </div> <input className="w-full border p-2 mb-3 rounded" value={name} onChange={e=>setName(e.target.value)} placeholder="Name" /> <input className="w-full border p-2 mb-3 rounded" value={username} onChange={e=>setUsername(e.target.value)} placeholder="Username (letters, numbers, . _)" /> <input className="w-full border p-2 mb-3 rounded" value={email} onChange={e=>setEmail(e.target.value)} placeholder="Email" /> <textarea className="w-full border p-2 mb-4 rounded" rows="3" value={bio} onChange={e=>setBio(e.target.value)} placeholder="Bio"></textarea> <div className="mb-4 pt-4 border-t"> <h4 className="font-bold text-sm mb-2 text-slate-500">Privacy Settings</h4> <div className="flex justify-between items-center mb-2"> <span className="text-sm">Show Activity Status</span> <input type="checkbox" checked={showActivity} onChange={e=>setShowActivity(e.target.checked)} className="w-4 h-4 accent-blue-500" /> </div> <div className="flex justify-between items-center"> <span className="text-sm">Read Receipts</span> <input type="checkbox" checked={readReceipts} onChange={e=>setReadReceipts(e.target.checked)} className="w-4 h-4 accent-blue-500" /> </div> </div> <div className="flex gap-2 mb-6 border-b pb-6"> <button onClick={handleSave} disabled={loading} className="bg-blue-500 text-white px-4 py-2 rounded flex-1 font-bold"> {loading ? 'Saving...' : 'Save'} </button> <button onClick={onClose} disabled={loading} className="bg-slate-200 px-4 py-2 rounded flex-1 font-bold">Cancel</button> </div> <button onClick={handleDeleteAccount} className="w-full text-red-500 text-sm font-bold border border-red-100 py-3 rounded bg-red-50 hover:bg-red-100">Delete Account</button> </div> </div> ); }
        async function deleteUserDataFromDB(uid) { const postsQ = query(collection(db, "posts"), where("userId", "==", uid)); const postsSnap = await getDocs(postsQ); await Promise.all(postsSnap.docs.map(doc => deleteDoc(doc.ref))); const f1Q = query(collection(db, "follows"), where("followerId", "==", uid)); const f1Snap = await getDocs(f1Q); const f2Q = query(collection(db, "follows"), where("followingId", "==", uid)); const f2Snap = await getDocs(f2Q); await Promise.all([...f1Snap.docs.map(d=>deleteDoc(d.ref)), ...f2Snap.docs.map(d=>deleteDoc(d.ref))]); const n1Q = query(collection(db, "notifications"), where("from", "==", uid)); const n1Snap = await getDocs(n1Q); const n2Q = query(collection(db, "notifications"), where("to", "==", uid)); const n2Snap = await getDocs(n2Q); await Promise.all([...n1Snap.docs.map(d=>deleteDoc(d.ref)), ...n2Snap.docs.map(d=>deleteDoc(d.ref))]); const m1Q = query(collection(db, "messages"), where("senderId", "==", uid)); const m1Snap = await getDocs(m1Q); const m2Q = query(collection(db, "messages"), where("receiverId", "==", uid)); const m2Snap = await getDocs(m2Q); await Promise.all([...m1Snap.docs.map(d=>deleteDoc(d.ref)), ...m2Snap.docs.map(d=>deleteDoc(d.ref))]); await deleteDoc(doc(db, "users", uid)); }

        function ProfilePage() {
            const [currentUser, setCurrentUser] = React.useState(null);
            const [isAdmin, setIsAdmin] = React.useState(false);
            const [isSuperAdmin, setIsSuperAdmin] = React.useState(false);
            const [profileUser, setProfileUser] = React.useState(null);
            const [posts, setPosts] = React.useState([]);
            const [isEditing, setIsEditing] = React.useState(false);
            const [showMenu, setShowMenu] = React.useState(false);
            const [showAbout, setShowAbout] = React.useState(false);
            const [isFollowing, setIsFollowing] = React.useState(false);
            const [followersCount, setFollowersCount] = React.useState(0);
            const [followingCount, setFollowingCount] = React.useState(0);
            const [showListModal, setShowListModal] = React.useState(false);
            const [listTitle, setListTitle] = React.useState('');
            const [listUsers, setListUsers] = React.useState([]);

            const urlParams = new URLSearchParams(window.location.search);
            const targetUid = urlParams.get('uid');

            React.useEffect(() => {
                onAuthStateChanged(auth, async (u) => {
                    if(!u) return window.location.href = "index.html";
                    
                    const myDoc = await getDoc(doc(db, "users", u.uid));
                    if (myDoc.exists() && myDoc.data().isBanned === true) {
                        await signOut(auth);
                        alert("Your account has been permanently disabled.");
                        window.location.href = "index.html";
                        return;
                    }

                    setCurrentUser(u);
                    
                    if(myDoc.exists()) {
                        const myData = myDoc.data();
                        if(myData.username === 'admin') {
                            setIsSuperAdmin(true); 
                            setIsAdmin(true);
                        } else if(myData.isAdmin === true) {
                            setIsAdmin(true);
                        }
                    }

                    const uidToLoad = targetUid || u.uid;
                    const unsubUser = onSnapshot(doc(db, "users", uidToLoad), async (d) => {
                        if(d.exists()) setProfileUser(d.data());
                    });

                    const q = query(collection(db, "posts"), where("userId", "==", uidToLoad));
                    const unsubPosts = onSnapshot(q, (s) => setPosts(s.docs.map(d => d.data())));

                    if (u.uid !== uidToLoad) {
                        const qFollow = query(collection(db, "follows"), where("followerId", "==", u.uid), where("followingId", "==", uidToLoad));
                        onSnapshot(qFollow, snap => setIsFollowing(!snap.empty));
                    }

                    const qFollowers = query(collection(db, "follows"), where("followingId", "==", uidToLoad));
                    onSnapshot(qFollowers, snap => setFollowersCount(snap.size));

                    const qFollowing = query(collection(db, "follows"), where("followerId", "==", uidToLoad));
                    onSnapshot(qFollowing, snap => setFollowingCount(snap.size));

                    return () => { unsubUser(); unsubPosts(); };
                });
            }, [targetUid]);

            const handleFollow = async () => {
                await addDoc(collection(db, "follows"), { followerId: currentUser.uid, followingId: profileUser.uid, timestamp: serverTimestamp() });
                await addDoc(collection(db, "notifications"), { to: profileUser.uid, from: currentUser.uid, type: 'follow', content: '', timestamp: serverTimestamp() });
            };

            const handleUnfollow = async () => {
                const q = query(collection(db, "follows"), where("followerId", "==", currentUser.uid), where("followingId", "==", profileUser.uid));
                const snap = await getDocs(q);
                snap.forEach(d => deleteDoc(d.ref));
            };

            const openList = async (type) => {
                setListTitle(type === 'followers' ? 'Followers' : 'Following');
                setListUsers([]); setShowListModal(true);
                const field = type === 'followers' ? 'followingId' : 'followerId'; 
                const targetField = type === 'followers' ? 'followerId' : 'followingId'; 
                const q = query(collection(db, "follows"), where(field, "==", profileUser.uid));
                const snap = await getDocs(q);
                const userIds = snap.docs.map(d => d.data()[targetField]);
                if (userIds.length > 0) {
                    const userDocs = await Promise.all(userIds.map(id => getDoc(doc(db, "users", id))));
                    setListUsers(userDocs.map(d => d.exists() ? d.data() : null).filter(u => u !== null));
                } else {
                    setListUsers([]);
                }
            };

            const toggleVerify = async () => {
                if(!isAdmin) return;
                const newStatus = !profileUser.isVerified;
                await updateDoc(doc(db, "users", profileUser.uid), { isVerified: newStatus, verifiedAt: newStatus ? serverTimestamp() : null });
                if (newStatus === true) {
                    await addDoc(collection(db, "notifications"), { to: profileUser.uid, from: 'admin', type: 'system_verify', content: "Your account was verified. You'll now see a blue verified badge next to your username.", timestamp: serverTimestamp() });
                }
            };

            const toggleBan = async () => {
                if(!isAdmin) return;
                if(profileUser.username === 'admin') return alert("You cannot ban the Super Admin!");
                const newStatus = !profileUser.isBanned;
                await updateDoc(doc(db, "users", profileUser.uid), { isBanned: newStatus });
                alert(newStatus ? "User has been Banned." : "User has been Unbanned.");
            };

            const toggleAdminStatus = async () => {
                if(!isSuperAdmin) return;
                if(profileUser.username === 'admin') return alert("Cannot remove Admin status from the Super Admin.");
                const newStatus = !profileUser.isAdmin;
                await updateDoc(doc(db, "users", profileUser.uid), { isAdmin: newStatus });
            };

            const handleAdminForceDelete = async () => {
                if(!isSuperAdmin) return;
                if(profileUser.username === 'admin') return alert("Super Admin cannot be deleted.");
                if(confirm(`FORCE DELETE USER "${profileUser.username}"?`)) {
                    await deleteUserDataFromDB(profileUser.uid);
                    alert("User data deleted.");
                    window.location.href = "home.html";
                }
            };

            const handleBlock = async () => { alert(`Blocked ${profileUser.username}`); setShowMenu(false); };

            if(!profileUser || !currentUser) return <div className="h-screen flex items-center justify-center"><div className="loader"></div></div>;
            
            const isMe = currentUser.uid === profileUser.uid;

            return (
                <div className="min-h-screen bg-slate-50 flex flex-col">
                    <Navbar onLogout={() => signOut(auth).then(()=>window.location.href='index.html')} />
                    {isEditing && <EditProfileModal user={profileUser} onClose={()=>setIsEditing(false)} />}
                    {showListModal && <UserListModal title={listTitle} users={listUsers} onClose={()=>setShowListModal(false)} />}
                    {showAbout && <AboutAccountModal user={profileUser} onClose={()=>setShowAbout(false)} />}
                    
                    <div className="flex-1 max-w-4xl mx-auto w-full p-4 relative">
                        <div className="absolute top-6 right-6 z-10">
                            <button onClick={()=>setShowMenu(!showMenu)}><span className="material-icons-round text-2xl">more_horiz</span></button>
                            {showMenu && (
                                <div className="absolute right-0 top-8 bg-white border shadow-lg rounded-lg w-52 py-2 z-20">
                                    <button onClick={()=>{setShowAbout(true); setShowMenu(false);}} className="w-full text-left px-4 py-2 hover:bg-slate-50 text-sm flex items-center gap-2">
                                        <span className="material-icons-round text-base">info</span> About this account
                                    </button>
                                    {!isMe && <button onClick={handleBlock} className="w-full text-left px-4 py-2 hover:bg-slate-50 text-sm text-red-500 font-bold">Block</button>}
                                </div>
                            )}
                        </div>

                        <div className="bg-white rounded-xl border p-6 mb-4 flex flex-col md:flex-row items-center md:items-start gap-6">
                            <img src={profileUser.photoURL || "https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png"} className="w-24 h-24 rounded-full border p-1 object-cover" />
                            <div className="flex-1 text-center md:text-left w-full">
                                <h2 className="text-2xl font-light flex items-center justify-center md:justify-start gap-2">
                                    {profileUser.username}
                                    {profileUser.isVerified && <span className="material-icons-round text-blue-500">verified</span>}
                                </h2>
                                
                                <div className="flex justify-center md:justify-start gap-2 mt-3 mb-4">
                                    {isMe ? (
                                        <button onClick={()=>setIsEditing(true)} className="bg-slate-100 px-4 py-1.5 rounded font-bold text-sm">Edit Profile</button>
                                    ) : (
                                        <>
                                            {isFollowing ? (
                                                <button onClick={()=>window.location.href=`message-list.html?chatWith=${profileUser.uid}`} className="bg-slate-100 px-6 py-1.5 rounded font-bold text-sm">Message</button>
                                            ) : (
                                                <button onClick={handleFollow} className="bg-blue-500 text-white px-6 py-1.5 rounded font-bold text-sm">Follow</button>
                                            )}
                                        </>
                                    )}
                                </div>

                                <p className="font-bold">{profileUser.name}</p>
                                <p className="text-sm text-slate-600 mb-4">{profileUser.bio || "No bio yet."}</p>
                                
                                <div className="flex justify-center md:justify-start gap-8 border-t md:border-t-0 pt-4 md:pt-0 cursor-pointer">
                                    <span><b>{posts.length}</b> posts</span>
                                    <span onClick={()=>openList('followers')}><b>{followersCount}</b> followers</span>
                                    <span onClick={()=>openList('following')}><b>{followingCount}</b> following</span>
                                </div>
                            </div>
                        </div>

                        {/* --- ADMIN CONTROLS SECTION (Only if I am admin AND it's NOT my profile) --- */}
                        {isAdmin && !isMe && (
                            <div className="bg-slate-800 text-white p-4 rounded-xl mb-6 shadow-lg">
                                <h3 className="font-bold text-yellow-400 mb-2 flex items-center gap-2"><span className="material-icons-round">admin_panel_settings</span> Admin Controls</h3>
                                
                                <div className="flex gap-4 mb-2">
                                    <button onClick={toggleVerify} className="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm font-bold flex-1">{profileUser.isVerified ? "Remove Blue Tick" : "Give Blue Tick"}</button>
                                    <button onClick={toggleBan} className={`${profileUser.isBanned ? 'bg-green-600' : 'bg-red-600'} hover:opacity-90 px-4 py-2 rounded text-sm font-bold flex-1`}>{profileUser.isBanned ? "Enable User" : "Ban User"}</button>
                                </div>

                                {isSuperAdmin && (
                                    <>
                                        <div className="flex gap-4 mb-2">
                                            <button onClick={toggleAdminStatus} className={`${profileUser.isAdmin ? 'bg-purple-800 border border-purple-500' : 'bg-purple-600'} hover:opacity-90 px-4 py-2 rounded text-sm font-bold flex-1`}>
                                                {profileUser.isAdmin ? "Remove Admin Access" : "Make Admin"}
                                            </button>
                                        </div>
                                        <button onClick={handleAdminForceDelete} className="w-full bg-red-800 hover:bg-red-900 px-4 py-2 rounded text-sm font-bold text-red-100 border border-red-700">Force Delete User (DB Only)</button>
                                    </>
                                )}
                            </div>
                        )}

                        <div className="grid grid-cols-3 gap-1 md:gap-4">
                            {posts.map((p, i) => <img key={i} src={p.imageUrl} className="w-full h-full object-cover aspect-square bg-slate-200" />)}
                        </div>
                    </div>
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ProfilePage />);
    </script>
</body>
</html>